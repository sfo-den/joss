<!DOCTYPE html>
<html lang="en">
<head>
  <title><%= Rails.application.settings['name'] %>: <%= @paper.title %></title>
  <%= stylesheet_link_tag    'application', media: 'all' %>
  <%= javascript_include_tag 'application' %>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <%= csrf_meta_tags %>
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/manifest.json">
  <link rel="home" type="application/atom+xml" title="Papers" href="/papers.atom">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <!-- clipboard.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js"></script>

    <!-- facebook open graph tags -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="<%= Rails.application.settings['url'] %>" />
  <meta property="og:title" content="<%= Rails.application.settings['name'] %>" />
  <meta property="og:description" content="<%= Rails.application.settings['name'] %>, <%= Rails.application.settings['tagline'] %>" />
  <meta property="og:image" content="<%= Rails.application.settings['logo_url'] %>" />

  <!-- twitter card tags additive with the og: tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" value="<%= Rails.application.settings['name'] %>" />
  <meta name="twitter:site" content="<%= Rails.application.settings['twitter'] %>">
  <meta name="twitter:description" value="<%= Rails.application.settings['name'] %>, <%= Rails.application.settings['tagline'] %>" />
  <meta name="twitter:image" content="<%= Rails.application.settings['logo_url'] %>" />
  <meta name="twitter:url" value="<%= Rails.application.settings['url'] %>" />
  <meta name="twitter:label1" value="ISSN" />
  <meta name="twitter:data1" value="<%= Rails.application.settings['twitter_issn'] %>" />

  <!-- Google Scholar Tags -->

  <% if @paper.doi? %>
  <meta name="citation_title" content="<%= @paper.title %>">
  <meta name="citation_author" content="<%= @paper.authors %>">
  <meta name="citation_publication_date" content="<%= @paper.accepted_at.strftime('%Y/%m/%d') %>">
  <meta name="citation_journal_title" content="<%= Rails.application.settings['name'] %>">
  <meta name="citation_pdf_url" content="<%= @paper.pdf_url %>">
  <meta name="citation_doi" content="<%= @paper.doi %>">
  <meta name="citation_issn" content="<%= Rails.application.settings['twitter_issn'] %>">
  <% end %>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47852178-4', 'auto');
    ga('send', 'pageview');

  </script>
</head>
<body>
  <a href="https://github.com/<%= setting(:github) %>" target="_blank" class="github-corner"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  <header class="masthead">
    <div class="wrapper">
      <a href="/" class="masthead-logo">
        <%= image_tag "logo_small.png" %> <span class='header-text'><%= Rails.application.settings['name'] %></span>
      </a>

      <nav class="masthead-nav">
        <%= link_to "Submit", new_paper_path %>
        <%= link_to "Papers", papers_path %>
        <%= link_to "About", about_path %>
        <% if current_user %>
          <strong><%= link_to current_user.nice_name, profile_path, :class => "profile-link" %></strong> &middot; <%= link_to "Sign out", signout_path %>
        <% else %>
          <%= link_to "Sign in", "/auth/orcid", :class => "btn btn-reverse" %>
        <% end %>
      </nav>
    </div>
  </header>
  <div class="wrapper">
    <%= render :partial => "shared/flashes" %>
    <%= render :partial => "shared/profile" if show_profile_banner? %>
  </div>

  <div class="wrapper">
    <div class="show-paper">
      <% unless @paper.doi? %>
      <%= render :partial => "status", :locals => { :paper => @paper } %>
      <%= render :partial => "papers/admin", :locals => { :paper => @paper } if current_user %>
      <% end %>
      <div class="columns">
        <% if @paper.doi? %>

        <h1><%= @paper.title %></h1>
        <p class="authors"><%= @paper.authors %></p>

        <span class="metadata">
          <strong>Article details</strong>
          <ul>
            <li><%= link_to "View review &raquo;".html_safe, @paper.review_url %></a></li>
            <li><%= link_to "Download paper &raquo;".html_safe, @paper.pdf_url %></li>
            <li><%= link_to "Software repository &raquo;".html_safe, @paper.repository_url %></li>
            <li><%= link_to "Software archive &raquo;".html_safe, @paper.clean_archive_doi %></li>
          </ul>

          <span class="status">Submitted:</span> <%= @paper.created_at.strftime('%d %B %Y') %><br />
          <span class="status">Accepted:</span> <%= @paper.accepted_at.strftime('%d %B %Y') %>

          <p class="citation"><strong>Cite as:</strong> <%= @paper.citation_string %></p>

          <p class="badge">
            <strong>Status badge</strong>
            <%= image_tag @paper.status_badge_url %><a href="#" class="clippy" data-clipboard-action="copy" data-clipboard-text="<%= @paper.markdown_code %>"><%= octicon "clippy", :height => 16,  :class => "", :"aria-label" => "Copy" %></a>
          </p>

          <p class="license">
            <strong>License</strong>
            Authors of <%= Rails.application.settings['abbreviation'] %> papers retain copyright.<br /><br />
            <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
          </p>

        </span>

        <object id="joss-paper" data="<%= @paper.pdf_url %>#toolbar=0&navpanes=0&scrollbar=0&statusbar=0&messages=0" type="application/pdf" style="width:670px; height:944px; float:right; margin-right: 10px;">
          <embed src="<%= @paper.pdf_url %>#toolbar=0&navpanes=0&scrollbar=0&statusbar=0&messages=0" type="application/pdf" />
        </object>

        <% else %>
        <div class="paper-body"><%= formatted_body(@paper) %></div>
        <div class="one-half column paper-meta">
          <p><strong>Repository Address</strong>: <%= link_to @paper.repository_url, @paper.repository_url %></p>
        </div>
        <div class="one-half column paper-meta">
          <% unless @paper.archive_doi %>
            <p><strong>Archive DOI</strong>: pending</p>
          <% else %>
            <p><strong>Archive DOI</strong>: <%= link_to @paper.archive_doi, @paper.doi_with_url %></p>
          <% end %>
        </div>
        <% end %>
      </div>
    </div>
  </div>

  <div class="wrapper">
    <div class="footer">
      <%= render partial: "content/layout/footer_partners" %>
      <p class="right">&copy; <%= setting(:name) %></p>
    </div>
  </div>
</body>
</html>
